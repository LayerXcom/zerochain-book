<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Zerochain Book</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body class="light">
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { } 
            if (theme === null || theme === undefined) { theme = default_theme; }
            document.body.className = theme;
            document.querySelector('html').className = theme + ' js';
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <ol class="chapter"><li class="affix"><a href="ch00-00-introduction.html">Introduction</a></li><li><a href="ch01-00-getting-started.html"><strong aria-hidden="true">1.</strong> Getting Started</a></li><li><ol class="section"><li><a href="ch01-01-installation.html"><strong aria-hidden="true">1.1.</strong> Installation</a></li><li><a href="ch01-02-tutorial.html"><strong aria-hidden="true">1.2.</strong> Turotial: Confidential payment</a></li></ol></li><li><a href="ch02-00-zface.html"><strong aria-hidden="true">2.</strong> ZFace</a></li><li><a href="ch03-00-confidential-payment.html"><strong aria-hidden="true">3.</strong> Confidential Payment</a></li><li><ol class="section"><li><a href="ch03-01-overview.html"><strong aria-hidden="true">3.1.</strong> Overview</a></li><li><a href="ch03-02-onchain-operations.html"><strong aria-hidden="true">3.2.</strong> On-chain operations</a></li><li><a href="ch03-03-statement-in-circuit.html"><strong aria-hidden="true">3.3.</strong> Statements in circuit</a></li></ol></li><li><a href="ch04-00-technology.html"><strong aria-hidden="true">4.</strong> Technology</a></li><li><ol class="section"><li><a href="ch04-01-zk-snarks.html"><strong aria-hidden="true">4.1.</strong> zk-SNARKs</a></li><li><a href="ch04-02-encryption.html"><strong aria-hidden="true">4.2.</strong> Encryption scheme</a></li><li><a href="ch04-03-key-components.html"><strong aria-hidden="true">4.3.</strong> Key components</a></li><li><a href="ch04-04-hierarchical-deterministic.html"><strong aria-hidden="true">4.4.</strong> Hierarchical Deterministic Wallets</a></li><li><a href="ch04-05-open-problems.html"><strong aria-hidden="true">4.5.</strong> Open problems</a></li></ol></li></ol>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title">Zerochain Book</h1> 

                        <div class="right-buttons">
                            <a href="print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                            
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <a class="header" href="#introduction" id="introduction"><h1>Introduction</h1></a>
<p>This documentation helps developers understand the core concepts of Zerochain and walk through the steps required to build Zerochain's node and send confidential transaction using Zerochain’s module.</p>
<p>Zerochain is a generic privacy-protecting layer on top of Substrate. It provides some useful substrate modules and toolkit for protecting user's privacy and sensitive data which would be stored on chain.
Zerochain protocol(v1) itself takes a hybrid solutions with Zether, Zcash toolchain, and of course Substrate.</p>
<ul>
<li>Zether: High-level privacy scheme which takes an account-based approach</li>
<li>Zcash toolchain: Basis Zero-knowledge proving system and elliptic curve operations</li>
<li>Substrate: Core blockchain layer which provides P2P networking, database, consensus engine, etc...</li>
</ul>
<div align="center">
<img src="https://user-images.githubusercontent.com/20852667/59009598-33972d80-8869-11e9-922b-1f86e18455a8.png" width="500px">
</div>
<p>The first goal for Zerochain is providing secure and efficient confidential/anonimous payment protocol for fungible assets. It means</p>
<ul>
<li>Transferred amounts are private</li>
<li>Each account balance is private</li>
<li>Identities of transactors are private</li>
</ul>
<div align="center">
<img src="https://user-images.githubusercontent.com/20852667/54678399-6d00ac80-4b48-11e9-9c8d-d1ec2b668761.png" width="500px">
</div>
<p>Core features of Zerochain are following:</p>
<ul>
<li>Efficient computational cost of zk-proving and verifying</li>
<li>Providing auditability for each account</li>
<li>Storage friendly confidentiality from wallet and blockchain perspective</li>
</ul>
<p>More precisely,</p>
<ul>
<li>Computational cost tends to be huge for zero-knowledge proving in general. Zerochain uses pre-processing zk-SNARKS which is kind of ZK proving systems and provides even small computational cost and proof size, there are some trade-off though.</li>
<li>Statement in zk-SNARKs is based on Zether protocol so that prover computational cost is even less compairing other privacy-protecting protocols.</li>
<li>Users can allow auditors to see how much they have balances by giving thier viewing key, but auditors cannot spend user's money by using it.</li>
<li>Zerochain's wallet don't need to run either full node or light client. Simply, it can send transactions via RPC API.</li>
<li>Zerochain is an account-based blockchain so it can avoid UTXO accumulation and save the growing storage.</li>
</ul>
<a class="header" href="#getting-started" id="getting-started"><h1>Getting Started</h1></a>
<p>In this section,  we will explain how to run Zerochain and send confidential/anonymous transactions.</p>
<a class="header" href="#installation" id="installation"><h1>Installation</h1></a>
<a class="header" href="#initial-setup" id="initial-setup"><h2>Initial Setup</h2></a>
<p>Setup latest rust environment.</p>
<pre><code>curl https://sh.rustup.rs -sSf | sh

rustup update stable
rustup update nightly
rustup target add wasm32-unknown-unknown --toolchain nightly
cargo +nightly install --git https://github.com/alexcrichton/wasm-gc
</code></pre>
<p>You will also need to install the following packages:</p>
<ul>
<li>Mac:</li>
</ul>
<pre><code>brew install cmake pkg-config openssl git llvm
</code></pre>
<ul>
<li>Linux:</li>
</ul>
<pre><code>sudo apt install cmake pkg-config libssl-dev git clang libclang-dev
</code></pre>
<a class="header" href="#building" id="building"><h2>Building</h2></a>
<p>Zerochan, then, can be building.</p>
<pre><code>git clone git@github.com:LayerXcom/zero-chain.git
cd zero-chain
./build.sh
cargo build --release
</code></pre>
<a class="header" href="#turotial-confidential-payment" id="turotial-confidential-payment"><h1>Turotial: Confidential payment</h1></a>
<p>This tutorial will explain the basic confidential transfer on Zerochain. Alice has the <strong>encrypted</strong> balance of 10,000 coins and sends <strong>encrypted</strong> 100 coins to you. The encrypted fee will be subtracted from her balance. (By default, a base fee parameter is set to 1.) So, Alice's balance will be 9,899 coins and you will get the 100 coins. All operations are done encrypted by ElGamal encryption and zk-SNARKs.</p>
<p>In this tutorial, we assumed you've already done the all installation explained <a href="ch01-01-installation.html">previous section</a>.</p>
<a class="header" href="#1-initial-setup" id="1-initial-setup"><h3>1. Initial setup</h3></a>
<p>First of all, you need to install <a href="ch02-00-zface.html">ZFace</a> to interact with Zerochain. ZFace is basically a low-level wallet core and cryptographic tools for Zerochain.</p>
<a class="header" href="#1-1-install-zface-in-the-root-zerochain-directory" id="1-1-install-zface-in-the-root-zerochain-directory"><h5>1-1. Install ZFace (In the root zerochain directory)</h5></a>
<pre><code>cargo install --force --path zface
</code></pre>
<p>Then, you can use CLI powerd by ZFace. Next thing you need to do for inisital setup is a preparation of zk-SNARKs parameters.</p>
<a class="header" href="#1-2-setup-for-zk-snarks" id="1-2-setup-for-zk-snarks"><h5>1-2. Setup for zk-SNARKs</h5></a>
<p>Generating a proving key and verifying key of zk-SNARKs, which are used for confidential payments.</p>
<pre><code>zface snark setup
</code></pre>
<a class="header" href="#2-run-zerochain-nodes" id="2-run-zerochain-nodes"><h3>2. Run Zerochain nodes</h3></a>
<p>Run a Zerochain node in other terminal screen. <code>--dev</code> flag is for specifying development mode.</p>
<pre><code>./target/release/zerochain --dev
</code></pre>
<p>If you want to clear your old chain's history:</p>
<pre><code>./target/release/zerochain purge-chain --dev
</code></pre>
<a class="header" href="#3-wallet-creation" id="3-wallet-creation"><h3>3. Wallet creation</h3></a>
<p>Create a new zerochainc wallet.</p>
<pre><code>wallet init
</code></pre>
<p>You will then be prompted to enter a wallet password and a initial account name.
<strong>Please, note carefully the following mnemonic words. They will be needed to recover your wallet.</strong></p>
<div align="center">
<img src="https://user-images.githubusercontent.com/20852667/60558171-34957f00-9d83-11e9-9094-e446cb9b2ce7.png" width="900px">
</div>
<a class="header" href="#4-interacting-with-zerochain" id="4-interacting-with-zerochain"><h3>4. Interacting with Zerochain</h3></a>
<a class="header" href="#4-1-transfer-initial-minted-coins-to-your-account" id="4-1-transfer-initial-minted-coins-to-your-account"><h5>4-1. Transfer initial minted coins to your account</h5></a>
<p>When you initialize your Zerochain, a specific Alice account has initial minted 10,000 coins (of couse, it is encrypted). You can transfer the encrypted coins from Alice to your just generated account by <code>debug</code> command.</p>
<pre><code>zface debug send -t &lt;YOUR ADDRESS&gt; -a &lt;AMOUNT&gt;
</code></pre>
<p>For example, the following command can transfer 100 coins to <code>5DC4kJ84b4KfVyddcFMYfy5skTJWVtxtWRETZo2i4nh8Ao1i</code> address. The address is depending on your account. Please copy and pasted printed-out address.</p>
<pre><code>zface debug send -t 5DC4kJ84b4KfVyddcFMYfy5skTJWVtxtWRETZo2i4nh8Ao1i -a 100
</code></pre>
<a class="header" href="#4-2-check-your-balanace" id="4-2-check-your-balanace"><h5>4-2. Check your balanace</h5></a>
<p>If the transferring coins was done successfully, your account should have 100 coins. You can check the balance by</p>
<pre><code>zface wallet balance
</code></pre>
<p>You will then be prompted to enter your passoword.</p>
<p>It's Done!</p>
<a class="header" href="#4-3-advanced-confidential-payment-between-your-accounts" id="4-3-advanced-confidential-payment-between-your-accounts"><h5>4-3. (Advanced) Confidential payment between your accounts</h5></a>
<p>You also can transfer encypted coins to your other your account by the following commands.</p>
<ul>
<li>Create other your account</li>
</ul>
<pre><code>zface wallet add-account
</code></pre>
<ul>
<li>Check your accounts list</li>
</ul>
<pre><code>zface wallet list
</code></pre>
<ul>
<li>Change default account to your first account who has 100 coins</li>
</ul>
<pre><code>zface wallet change-account -n &lt;ACCOUNT_NAME&gt;
</code></pre>
<ul>
<li>Transfer encrypted coins to your new account</li>
</ul>
<pre><code>zface tx transfer -t &lt;ADDRESS&gt; -a &lt;AMOUNT&gt;
</code></pre>
<a class="header" href="#zface-an-interface-for-interacting-with-zerochain" id="zface-an-interface-for-interacting-with-zerochain"><h1>ZFace: An interface for interacting with Zerochain</h1></a>
<p>(WIP)</p>
<p>ZFace is a low-level wallet core and cryptographic tools for Zerochain.</p>
<p>In this section, we explained the usage of CLI tools powered by ZFace. The CLI tool has mainly four subcommands which is explained later.</p>
<ul>
<li>snark: Operations around zk-SNARKs</li>
<li>wallet: Operations around wallet</li>
<li>tx: Operatipons around sending transactions to Zerochain</li>
<li>debug: Debugging and testing commands</li>
</ul>
<a class="header" href="#creating-a-new-wallet" id="creating-a-new-wallet"><h3>Creating a new wallet</h3></a>
<p>For security reasons, the cryptographic materials are stored encryped by providing a password.</p>
<p>To do this, run:</p>
<pre><code>zface wallet init
</code></pre>
<p>You will then be prompted to enter a password. This password will be used to encrypt your mnemonics of your wallet. Wallet files are stored in zface directory located in the following path.</p>
<table><thead><tr><th>Platform </th><th> Value </th><th> Example </th></tr></thead><tbody>
<tr><td> Linux </td><td> $XDG_DATA_HOME or $HOME/.local/share/zface </td><td> /home/alice/.local/share/zface </td></tr>
<tr><td> macOS </td><td> $HOME/Library/Application Support/zface </td><td> /Users/Alice/Library/Application Support/zface </td></tr>
<tr><td> Windows </td><td> {FOLDERID_LocalAppData}\zface </td><td> C:\Users\Alice\AppData\Local\zface </td></tr>
</tbody></table>
<a class="header" href="#adding-a-account" id="adding-a-account"><h3>Adding a account</h3></a>
<p>You can add a new account into your wallet.</p>
<pre><code>zface wallet add-account
</code></pre>
<a class="header" href="#show-accounts-list" id="show-accounts-list"><h3>Show accounts list</h3></a>
<p>It will show your accounts in your wallet.</p>
<pre><code>zface wallet list
</code></pre>
<a class="header" href="#change-default-account" id="change-default-account"><h3>Change default account</h3></a>
<pre><code>zface wallet change-account -n &lt;ACCOUNT_NAME&gt;
</code></pre>
<a class="header" href="#recover-a-wallet-from-mnemonic" id="recover-a-wallet-from-mnemonic"><h3>Recover a wallet from mnemonic</h3></a>
<p>(TODO)</p>
<pre><code>zface wallet recover
</code></pre>
<p>You will then be prompted to enter a mnemonic to recover your wallet.</p>
<a class="header" href="#get-an-accounts-balance" id="get-an-accounts-balance"><h3>Get an account's balance</h3></a>
<pre><code>zface wallet balance
</code></pre>
<a class="header" href="#setup-for-zk-proving" id="setup-for-zk-proving"><h3>Setup for zk-proving</h3></a>
<pre><code>zface snark setup
</code></pre>
<a class="header" href="#send" id="send"><h3>send</h3></a>
<pre><code>zface tx transfer -t &lt;RECIPIENT_ADDRESS&gt; -a &lt;AMOUNT&gt;
</code></pre>
<p>You will then be prompted to enter a transferred amount and a destination address.</p>
<a class="header" href="#managing-encrypted-assets" id="managing-encrypted-assets"><h3>Managing encrypted assets</h3></a>
<ul>
<li>Issue new encrypted assets</li>
</ul>
<pre><code>zface tx asset-issue -a &lt;AMOUNT&gt;
</code></pre>
<ul>
<li>Send encrypted assets</li>
</ul>
<pre><code>zface tx asset-transfer -t &lt;RECIPIENT_ADDRESS&gt; -a &lt;AMOUNT&gt; -i &lt;ASSET_ID&gt;
</code></pre>
<a class="header" href="#test-for-debugging" id="test-for-debugging"><h2>Test for debugging</h2></a>
<a class="header" href="#print-key-components" id="print-key-components"><h3>Print key components</h3></a>
<pre><code>zface debug key-init
</code></pre>
<a class="header" href="#send-tx-for-debuggin" id="send-tx-for-debuggin"><h3>Send tx for debuggin</h3></a>
<pre><code>zface debug send -s &lt;SENDER_SEED&gt; -t &lt;RECPIENT_ADDRESS&gt; -a &lt;AMOUNT&gt;
</code></pre>
<a class="header" href="#print-transaction-components" id="print-transaction-components"><h3>Print transaction components</h3></a>
<pre><code>zface debug print-tx
</code></pre>
<a class="header" href="#confidential-payment" id="confidential-payment"><h1>Confidential Payment</h1></a>
<p><a href="https://github.com/LayerXcom/zero-chain/blob/master/runtime/src/conf_transfer.rs">runtime/src/conf_transfer.rs</a> provides a confidential payment module.</p>
<p>In this section, we will explain what is &quot;confidential payment&quot; and how it works.</p>
<a class="header" href="#overview" id="overview"><h1>Overview</h1></a>
<div align="center">
<img src="https://user-images.githubusercontent.com/20852667/59552781-fe57b180-8fc5-11e9-8e71-a02efef85622.png" width="800px">
</div>
<a class="header" href="#on-chain-operations" id="on-chain-operations"><h1>On-chain operations</h1></a>
<p>In the basic confidential payment scheme in <a href="https://github.com/LayerXcom/zero-chain/blob/master/runtime/src/conf_transfer.rs">conf_transfer module</a>, there is one public dispatchable function <code>confidential_transfer</code>. It takes some parameters such as a zero-knowledege proof, some ciphertexts and addresses.
In this function, mainly three internal functions are called. First one is <code>roll_over</code> function for pending transfers which is explained later. <code>roll_over</code> allows us to send transactions asynchronously and protect from front-running attacks. We rollover an account in an epoch when the first message from this account is received, soone message rolls over only one account. To achieve this, we define a separate (internal) method for rolling over, and the first thing every other method does is to call this method.</p>
<p>Second one is <code>validate_proof</code> function for varifying zk proofs. (For more details: <a href="ch03-03-statement-in-circuit.html">Statements in circuit</a>) Last one is mutating storage to add encrypted coins to recipient's encrypted balance and subtract it from sender's encrypted balance.</p>
<a class="header" href="#pending-transfer" id="pending-transfer"><h2>Pending transfer</h2></a>
<p>Zerochain uses a pending transfer strategy to prevent from front-running attacks. This attack is that a malicious attacker can watch alice's transaction and his transaction gets processed first, then alice's transaction will be rejected because the proof will not be valid anymore. More precisely, alice's encrypted balance is updated, so public input to <code>validate_proof</code> parameter is no longer correct.</p>
<p>To solve this problems, we have <code>encrypted_balance</code> and <code>pending_transfer</code> mappings to store account's balances on-chain. <code>encrypted_balanace</code> is a actual balance mapping and <code>pending_transfer</code> is like a temporary storage in order to store incoming payments.</p>
<p>Let's think a simple case that alice sends encrypted 5 coins to bob. The encrypted 5 coins will be stored bob's <code>pending_transfer</code> at first, not affect bob's <code>encrypted_balance</code>. In the next time when someone sends coins to bob or bob sends coins to someone, <code>rollover</code> function will be invoked and balances are transferred from <code>pending_transfer</code> map to <code>encrypted_balance</code> map.</p>
<p>More details in Section 3.1: https://crypto.stanford.edu/~buenz/papers/zether.pdf</p>
<a class="header" href="#subtracting-encrypted-fees" id="subtracting-encrypted-fees"><h2>Subtracting encrypted fees</h2></a>
<p>Fees are subtracted from sender's encrypted balance based on <code>transaction_base_fee</code> storage key in the <code>conf_transfer</code> module.
<code>transaction_base_fee</code> is set to <code>1</code> by default in <a href="https://github.com/LayerXcom/zero-chain/blob/67655966f3dd067011ea4fd215f128784b53ffd0/src/chain_spec.rs#L136">chain_spec.rs</a>.</p>
<a class="header" href="#statement-in-circuit" id="statement-in-circuit"><h1>Statement in circuit</h1></a>
<p>Circuit implementation can be found <a href="https://github.com/LayerXcom/zero-chain/blob/master/core/proofs/src/circuit/transfer.rs">here</a>.</p>
<p>(TODO)</p>
<a class="header" href="#technology" id="technology"><h1>Technology</h1></a>
<p>In this section, we will explain core technologies which is used in Zerochain.</p>
<a class="header" href="#zk-snarks" id="zk-snarks"><h1>zk-SNARKs</h1></a>
<p>(TODO)</p>
<a class="header" href="#encryption-scheme" id="encryption-scheme"><h1>Encryption scheme</h1></a>
<p>All transferred amounts and account balances are encrypted in Zerochain, but you have to compute(add or sub) these with encrypted at the time of the payment.</p>
<p>Zerochain achieves it by using the special encryption algorithm called “Additive homomorphic encryption”. As you can guess from the name, it can compute the addition(or subtraction) with encrypted. More specifically, Zerochain uses “Lifted-ElGamal encryption” to get efficient encryption and additive homomorphic property. (You can think it’s like Pedersen commitment in terms of additive homomorphic property, but Lifted-Elgamal is an asymmetric key encryption algorithm, not a commitment.)</p>
<a class="header" href="#encryption" id="encryption"><h2>Encryption</h2></a>
<p>You can compute the ciphertext like bellow.</p>
<p>ciphertext:</p>
<div align="left">
<img src="https://user-images.githubusercontent.com/20852667/59552793-3e1e9900-8fc6-11e9-9227-2eaba1eaf862.png" width="150px">
</div>
<p>where v: transferred amount, r: pseudorandomness, G: generator point, s: secret key (the corresponding public key: sG)</p>
<a class="header" href="#decryption" id="decryption"><h2>Decryption</h2></a>
<p>You can decrypt it by using the given ciphertext and secret key.</p>
<div align="left">
<img src="https://user-images.githubusercontent.com/20852667/59552795-437be380-8fc6-11e9-9e3c-0f26d1556443.png" width="250px">
</div>
<p>Then, you realize you have to solve the discrete logarithm problem to get the amount “v”. Practically, “v” would be just a small bits integer (like 32bits) and vG(v=1,2,…) are computed in advance. (On the other hand, the secret key “s” and pseudorandom “r” will be a huge number so that one cannot solve the discrete logarithm.)</p>
<p>The decryption of Lifted-ElGamal is not efficient like this, but we chose it as an encryption algorithm in Zerochain due to the efficient encryption and the good compatibility with zero-knowledge proof.</p>
<a class="header" href="#additive-homomorphic" id="additive-homomorphic"><h2>Additive homomorphic</h2></a>
<p>Let’s think the case the user has encrypted 10 coins as his balance, then is transferred encrypted 5 coins. That is the addition of ciphertext with v = 10 as balance and v’ = 5 as amount.</p>
<div align="left">
<img src="https://user-images.githubusercontent.com/20852667/59552799-4971c480-8fc6-11e9-9f44-0647b47102cb.png" width="600px">
</div>
<p>This is the same form as the ciphertext you see above. You can get the amount “15” by using secret key “s” in the same way. All the additions of ciphertext are computed on-chain at the time of updating the balance.</p>
<a class="header" href="#key-components" id="key-components"><h1>Key components</h1></a>
<div align="center">
<img src="https://user-images.githubusercontent.com/20852667/59552701-57731580-8fc5-11e9-8bee-ccf12e0cb051.png" width="600px">
</div>
<p>These arrows are one-way. For example, you cannot derive a spending key from a decryption key, but you can derive a decryption key from a spending key.</p>
<p>These bunch of keypairs allow us to get a auditability, zk-proofs delegation and hide a signer's identity.</p>
<p>This key components scheme is modified and simplified version of zcash sapling's one to be compatible with Zerochain.</p>
<a class="header" href="#signing-key" id="signing-key"><h3>Signing key</h3></a>
<p>Every time you sign a transaction, a re-randomized signing key will be generated so that a signature will be different from the previous one. It helps to make it quite difficult to distinguish the sender's address because the signature of the same sender is no longer same.</p>
<a class="header" href="#decryption-key" id="decryption-key"><h3>Decryption key</h3></a>
<p>A decryption key works as a viewing key which allows only this key's owener to see the encrypted balance which is  stored on-chain.</p>
<p>If you pass your decryption key to auditors, they can see your current balance, but cannot spend your coins of course.</p>
<a class="header" href="#encryption-key" id="encryption-key"><h3>Encryption key</h3></a>
<p>Encryption key is a public key can be used to encrypt all transferred amounts and balances.</p>
<a class="header" href="#hierarchical-deterministic-keys" id="hierarchical-deterministic-keys"><h1>Hierarchical Deterministic Keys</h1></a>
<a class="header" href="#open-problems" id="open-problems"><h1>Open problems</h1></a>
<a class="header" href="#trusted-setup" id="trusted-setup"><h3>Trusted setup</h3></a>
<a class="header" href="#linearly-scaling-computational-cost-in-terms-of-anonimity-set" id="linearly-scaling-computational-cost-in-terms-of-anonimity-set"><h3>Linearly scaling computational cost in terms of anonimity set</h3></a>
<a class="header" href="#limited-functionalities-for-privacy-protecting-operations" id="limited-functionalities-for-privacy-protecting-operations"><h3>Limited functionalities for privacy-protecting operations</h3></a>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                

                
            </nav>

        </div>

        

        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        
        
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
        
        

    </body>
</html>
